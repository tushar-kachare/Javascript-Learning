<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <h1>Hello Javascript</h1>    
</body>
<script>
    cart = ['pants','chaddi','jhuta']
    
    console.log("Promise is created");
    
    // const promise = createOrder(cart)
    // promise.then(function (orderId) {
    //     console.log("Promise is resolved successfully " , orderId);
    // })
    createOrder(cart)
        .then(function(orderId) {
            console.log(`orderId is ${orderId}`);
            return orderId
        })
        .then(function (orderId) {
            return proceedToPayment(orderId)
        })
        .then(function (message) {
            console.log(message);
        })
        .catch(function (err) {
            console.log("Cart is not valid");
        })
    
    function createOrder(cart) {

        const pr = new Promise(function (resolve, reject) {

            if(!validate(cart)) {
                const err = new Error('Promise is rejected')
                setTimeout(() => {
                    reject(err) // reject promise with result message (err)
                }, 5000);
            }
            else {
                orderId = '13131'
                setTimeout(function () {
                    resolve(orderId) // resolve promise returning orderId
                },5000)
            }
        })
        return pr
    }
    function validate(cart) {
        return true;
    }
    
    function proceedToPayment(orderId) {
        return new Promise(function(resolve,reject) {
            setTimeout(function () {
                resolve(`Payment for orderId ${orderId} is successful`)
            },5000)
        })
    }
    
    console.log("End of code");
    
</script>
</html>